{% extends 'base.html' %}

{% block content %}
<div style="max-width: 700px; margin: 0 auto;">
    <!-- –ü–æ—Å—Ç -->
    <div style="margin-top: 10px;">
   <form method="post" action="{% url 'like_post' post.id %}" style="display: inline;">
    {% csrf_token %}
    <button type="submit" style="background: none; border: none; cursor: pointer;">
        {% if post.liked %}
            ‚ù§Ô∏è (–û—Ç–º–µ–Ω–∏—Ç—å)
        {% else %}
            üíô (–õ–∞–π–∫–Ω—É—Ç—å)
        {% endif %}
    </button>
</form>
    | ‚ù§Ô∏è {{ post.likes_count }} &nbsp; üí¨ {{ post.comments_count }}
</div>
    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: #fafafa;">
        <div>
            <strong>{{ post.author.username }}</strong>
            <small style="color: #666;">{{ post.created_at|date:"d.m.Y H:i" }}</small>
        </div>
        <div style="margin: 15px 0;">
            {{ post.content|linebreaks }}
        </div>
        <div style="color: #555; font-size: 14px;">
            ‚ù§Ô∏è {{ post.likes_count }} &nbsp; üí¨ {{ post.comments_count }}
        </div>
    </div>

    <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ -->
    <h3 style="margin-top: 25px;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ comments|length }}):</h3>

    {% if comments %}
        {% for comment in comments %}
            <div style="border-bottom: 1px solid #eee; padding: 10px 0; margin: 10px 0;">
                <div>
                    <strong>{{ comment.author.username }}</strong>
                    <small>{{ comment.created_at|date:"d.m.Y H:i" }}</small>
                    {% if user.is_authenticated and user == comment.author %}
                        | <a href="{% url 'comment_edit' comment.id %}">‚úèÔ∏è</a>
                        | <a href="{% url 'comment_delete' comment.id %}" style="color: #dc3545;">üóëÔ∏è</a>
                    {% endif %}
                </div>
                <div>{{ comment.content|linebreaks }}</div>
            </div>
        {% endfor %}
    {% else %}
        <p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.</p>
    {% endif %}

    <!-- –§–æ—Ä–º–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
    {% if user.is_authenticated %}
        <h4 style="margin-top: 25px;">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</h4>
        <form method="post">
            {% csrf_token %}
            {{ form.content }}
            <button type="submit" style="margin-top: 10px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </form>
    {% else %}
        <p><a href="{% url 'login' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.</p>
    {% endif %}

    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–º -->
    <div style="margin-top: 25px;">
        {% if user.is_authenticated %}
            {% if user == post.author %}
                <a href="{% url 'post_edit' post.id %}">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç</a> |
                <a href="{% url 'post_delete' post.id %}" style="color: #dc3545;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</a>
            {% endif %}
        {% endif %}
        <a href="{% url 'home' %}" style="margin-left: 15px;">‚Üê –í—Å–µ –ø–æ—Å—Ç—ã</a>
    </div>
</div>
{% endblock %}